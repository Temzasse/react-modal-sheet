"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),n=require("react-dom"),r=require("framer-motion"),o=(e=require("react-merge-refs"))&&"object"==typeof e&&"default"in e?e.default:e;function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}var s="undefined"!=typeof window;function l(e){var t=document.querySelector("body"),n=document.getElementById(e),r=document.getElementById("react-modal-sheet-highlight");n&&r&&(n.style.removeProperty("border-top-right-radius"),n.style.removeProperty("border-top-left-radius"),n.style.removeProperty("transform"),r.style.opacity="0",n.addEventListener("transitionend",(function e(){var o;n.style.removeProperty("overflow"),n.style.removeProperty("will-change"),n.style.removeProperty("transition"),t.style.removeProperty("background-color"),n.removeEventListener("transitionend",e),null==(o=r.parentNode)||o.removeChild(r)})))}var c=t.createContext(void 0),d=function(){var e=t.useContext(c);if(!e)throw Error("Sheet context error");return e},u=function(e){var n=t.useRef();return t.useEffect((function(){n.current=e})),n.current},f={wrapper:{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999999,overflow:"hidden"},backdrop:{zIndex:1,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(51, 51, 51, 0.5)",touchAction:"none"},container:{zIndex:2,position:"absolute",left:0,bottom:0,width:"100%",backgroundColor:"#fff",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",boxShadow:"0px -2px 16px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column"},headerWrapper:{width:"100%"},header:{height:"40px",width:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},indicator:{width:"18px",height:"4px",borderRadius:"99px",backgroundColor:"#ddd"},content:{flex:1,overflow:"auto",position:"relative"}},p=t.forwardRef((function(e,o){var d=e.children,p=e.isOpen,m=e.onClose,y=e.onOpenStart,g=e.onOpenEnd,h=e.onCloseStart,v=e.onCloseEnd,b=e.onSnap,C=e.snapPoints,E=e.initialSnap,x=void 0===E?0:E,w=e.rootId,O=e.springConfig,S=void 0===O?{stiffness:300,damping:30,mass:.2}:O,R=e.disableDrag,k=void 0!==R&&R,P=i(e,["children","isOpen","onClose","onOpenStart","onOpenEnd","onCloseStart","onCloseEnd","onSnap","snapPoints","initialSnap","rootId","springConfig","disableDrag"]),j=t.useState(!1),D=j[0],I=j[1],M=t.useState(!1),q=M[0],T=M[1],A=t.useRef(null),N=t.useRef({onOpenStart:y,onOpenEnd:g,onCloseStart:h,onCloseEnd:v}),H=r.useMotionValue(0),B=r.useMotionValue(s?window.innerHeight:0),L=r.useSpring(B,S),z=q?B:L,V=p?"auto":"none",W=t.useCallback((function(e,t){var n=t.delta,r=B.getVelocity();r>0&&H.set(10),r<0&&H.set(-10),B.set(Math.max(B.get()+n.y,0))}),[]),X=t.useCallback((function(){B.set(L.get()),T(!0)}),[]),_=t.useCallback((function(e,t){var n,r;if(t.velocity.y>500)m();else{var o=A.current.getBoundingClientRect().height,a=C?(n=C.map((function(e){return o-e})),r=B.get(),n.reduce((function(e,t){return Math.abs(t-r)<Math.abs(e-r)?t:e}))):B.get()/o>.6?o:0;if(L.set(a),C&&b){var i=Math.abs(Math.round(C[0]-a)),s=C.indexOf(i);b(s)}a>=o&&m(),T(!1)}H.set(0)}),[m,b]);t.useEffect((function(){N.current={onOpenStart:y,onOpenEnd:g,onCloseStart:h,onCloseEnd:v}})),t.useEffect((function(){I(!0)}),[]),t.useEffect((function(){C&&b&&D&&b(p?x:C.length-1)}),[p]),t.useImperativeHandle(o,(function(){return{snapTo:function(e){if(C&&void 0!==C[e]){var t=A.current.getBoundingClientRect().height,n=t-C[e];L.set(n),b&&b(e),n>=t&&m()}}}})),function(e,n){var r=u(e);t.useEffect((function(){n&&!r&&e?function(e){var t=document.querySelector("body"),n=document.querySelector("#"+e);if(n){var r=window.innerHeight,o=(r-24)/r;t.style.backgroundColor="#000",n.style.overflow="hidden",n.style.willChange="transform",n.style.transition="transform 200ms linear",n.style.transform="translateY(calc(env(safe-area-inset-top) + 12px)) scale("+o+")",n.style.borderTopRightRadius="10px",n.style.borderTopLeftRadius="10px";var a=document.createElement("div");a.setAttribute("aria-hidden","true"),a.id="react-modal-sheet-highlight",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.bottom="0px",a.style.right="0px",a.style.opacity="0",a.style.transition="opacity 200ms linear",a.style.backgroundColor="rgba(150, 150, 150, 0.1)",n.appendChild(a),requestAnimationFrame((function(){return a.style.opacity="1"}))}}(n):n&&!e&&r&&l(n)}),[e,r]),t.useEffect((function(){return function(){n&&e&&l(n)}}),[e])}(p,w);var F={y:z,sheetRef:A,isOpen:p,isDragging:q,initialSnap:x,snapPoints:C,indicatorRotation:H,callbacks:N,dragProps:k?{}:{drag:"y",dragElastic:0,dragConstraints:{top:0,bottom:0},dragMomentum:!1,onDrag:W,onDragStart:X,onDragEnd:_}},Y=a({},P,{ref:o,style:a({},f.wrapper,{pointerEvents:V})});return D?n.createPortal(t.createElement(c.Provider,{value:F},t.createElement("div",Object.assign({},Y),t.createElement(r.AnimatePresence,null,p?t.Children.map(d,(function(e,n){return t.cloneElement(e,{key:"sheet-child-"+n})})):null))),document.body):t.createElement("div",Object.assign({},Y))})),m="calc(100% - env(safe-area-inset-top) - 34px)",y=t.forwardRef((function(e,n){var s=e.children,l=e.style,c=void 0===l?{}:l,p=i(e,["children","style"]),y=d(),g=y.y,h=y.snapPoints,v=y.initialSnap,b=void 0===v?0:v,C=y.sheetRef,E=function(e,n){var r=u(e),o=t.useRef(!1),a=t.useCallback((function(){o.current?(null==n.current.onCloseEnd||n.current.onCloseEnd(),o.current=!1):(null==n.current.onOpenEnd||n.current.onOpenEnd(),o.current=!0)}),[e,r]);return t.useEffect((function(){!r&&e?null==n.current.onOpenStart||n.current.onOpenStart():!e&&r&&(null==n.current.onCloseStart||n.current.onCloseStart())}),[e,r]),{handleAnimationComplete:a}}(y.isOpen,y.callbacks).handleAnimationComplete,x=h?h[0]-h[b]:0,w=h?h[0]:null,O=w?"min("+w+"px, "+m+")":m;return t.createElement(r.motion.div,Object.assign({},p,{ref:o([C,n]),className:"react-modal-sheet-container",style:a({},f.container,{height:O},c,{y:g}),initial:{y:window.innerHeight},animate:{y:x,transition:{type:"tween"}},exit:{y:window.innerHeight},onAnimationComplete:E}),s)})),g=t.forwardRef((function(e,n){var o=e.children,s=e.disableDrag,l=void 0!==s&&s,c=e.style,u=void 0===c?{}:c,p=i(e,["children","disableDrag","style"]),m=d().dragProps;return t.createElement(r.motion.div,Object.assign({},p,{ref:n,className:"react-modal-sheet-content",style:a({},f.content,u)},l?{}:m),o)})),h=t.forwardRef((function(e,n){var o=e.children,s=e.disableDrag,l=void 0!==s&&s,c=e.style,u=void 0===c?{}:c,p=i(e,["children","disableDrag","style"]),m=d(),y=m.indicatorRotation,g=m.dragProps,h=r.useTransform(y,(function(e){return"translateX(2px) rotate("+e+"deg)"})),v=r.useTransform(y,(function(e){return"translateX(-2px) rotate("+-1*e+"deg)"}));return t.createElement(r.motion.div,Object.assign({},p,{ref:n,style:a({},f.headerWrapper,u)},l?{}:g),o||t.createElement("div",{className:"react-modal-sheet-header",style:f.header},t.createElement(r.motion.span,{className:"react-modal-sheet-drag-indicator",style:a({},f.indicator,{transform:h})}),t.createElement(r.motion.span,{className:"react-modal-sheet-drag-indicator",style:a({},f.indicator,{transform:v})})))})),v=t.forwardRef((function(e,n){var o,s=e.style,l=void 0===s?{}:s,c=i(e,["style"]),d=(o=c).onClick||o.onTap?r.motion.button:r.motion.div;return t.createElement(d,Object.assign({},c,{ref:n,className:"react-modal-sheet-backdrop",style:a({},f.backdrop,l),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}))})),b=p;b.Container=y,b.Header=h,b.Content=g,b.Backdrop=v,exports.default=b;
//# sourceMappingURL=react-modal-sheet.cjs.production.min.js.map
